#!/bin/sh
set -e

echo "ğŸ”’ Running pre-commit security checks..."

#######################################
# 1. Block .env files
#######################################
ENV_FILES=$(git diff --cached --name-only | grep -E '(^|/)\.env$' || true)

if [ -n "$ENV_FILES" ]; then
  echo "âŒ ERROR: .env files must NOT be committed."
  echo "Found:"
  echo "$ENV_FILES"
  echo "Use .env.example instead."
  exit 1
fi

#######################################
# 2. Scan staged files for secrets
#######################################
#echo "ğŸ” Scanning staged files for secrets with gitleaks..."
#
#gitleaks protect \
#  --staged \
#  --redact \
#  --verbose

echo "âœ… Security checks passed."
